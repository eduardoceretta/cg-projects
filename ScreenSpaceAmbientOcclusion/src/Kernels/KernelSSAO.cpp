/**
 *	Eduardo Ceretta Dalla Favera
 *  eduardo.ceretta@gmail.com
 *  Apr 2011
 *
 *  Perform the calculation of the Screen Space Ambient Occlusion.
 *  Receive projection matrix information and reprojects the pixels obtained from the depth
 *  input textures and does the calculation of the occlusion that the neighborhood of a pixel 
 *  causes using spheres as occludes approximation.
 */

#include "KernelSSAO.h"

/**
 * Sampler texture data.
 *  Creates a 2D texture containing binary information, if the pixel must or not be accessed
 */
//#define SAMPLER_QUAD

/**
 * Sampler texture data.
 *  Creates a 1D texture containing the respective index of the neighborhood access
 */
#define SAMPLER_VECTOR

#ifdef SAMPLER_QUAD
  #if 0
  //13
  //**#*#
  //*###*
  //*#0#*
  //####*
  //#**#*
  #define SAMPLER_SIZE 2
  #define SAMPLER_DATA { \
      { 0, 0, 1, 0, 1}, \
      { 0, 1, 1, 1, 0}, \
      { 0, 1, 0, 1, 0}, \
      { 1, 1, 1, 1, 0}, \
      { 1, 0, 0, 1, 0}, \
    }
  #elif 0
  //16
  //#******
  //*****#*
  //#*###**
  //**#0#**
  //*####**
  //*#**#**
  //****#*#
  #define SAMPLER_SIZE 3
  #define SAMPLER_DATA { \
      {1, 0, 0, 0, 0, 0, 0}, \
      {0, 0, 0, 0, 0, 1, 0}, \
      {1, 0, 1, 1, 1, 0, 0}, \
      {0, 0, 1, 0, 1, 0, 0}, \
      {0, 1, 1, 1, 1, 0, 0}, \
      {0, 1, 0, 0, 1, 0, 0}, \
      {0, 0, 0, 0, 1, 0, 1}, \
    }
  #elif 0
  //30
  //##***#*#*
  //*#*******
  //******#**
  //##*###***
  //#**#0#**#
  //#*####***
  //**#**#***
  //*****#*##
  //**#**##*#
  #define SAMPLER_SIZE 4
  #define SAMPLER_DATA { \
      {1, 1, 0, 0, 0, 1, 0, 1, 0}, \
      {0, 1, 0, 0, 0, 0, 0, 0, 0}, \
      {0, 0, 0, 0, 0, 0, 1, 0, 0}, \
      {1, 1, 0, 1, 1, 1, 0, 0, 0}, \
      {1, 0, 0, 1, 0, 1, 0, 0, 1}, \
      {1, 0, 1, 1, 1, 1, 0, 0, 0}, \
      {0, 0, 1, 0, 0, 1, 0, 0, 0}, \
      {0, 0, 0, 0, 0, 1, 0, 1, 1}, \
      {0, 0, 1, 0, 0, 1, 1, 0, 1}, \
    }
  #elif 0
  //44
  //*##**#**##*
  //*##***#*#**
  //**#********
  //*******#***
  //*##*###****
  //##**#0#**#*
  //*#*####***#
  //***#**#***#
  //******#*##*
  //***#**##*##
  //*****##*###
  #define SAMPLER_SIZE 5
  #define SAMPLER_DATA { \
      {0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0}, \
      {0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0}, \
      {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
      {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0}, \
      {0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0}, \
      {1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0}, \
      {0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1}, \
      {0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1}, \
      {0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0}, \
      {0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1}, \
      {0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1}  \
    }
  #elif 0
  //70
  //#*##*##*#*#
  //*#*#****#**
  //##*####*###
  //###****##**
  //**#*###*###
  //**#*#0##*##
  //*#**####*##
  //#########*#
  //*##**######
  //#######*###
  //**###**#*##
  #define SAMPLER_SIZE 5
  #define SAMPLER_DATA { \
    {1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1 }, \
    {0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0 }, \
    {1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1 }, \
    {1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0 }, \
    {0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1 }, \
    {0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1 }, \
    {0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1 }, \
    {0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1 }, \
    {0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1 }, \
  }
  #elif 0
  // 0
  //***********
  //**#**#*****
  //***********
  //***********
  //****###****
  //****#0#****
  //****###*#**
  //*#*********
  //***********
  //***********
  //#**********
  #define SAMPLER_SIZE 5
  #define SAMPLER_DATA { \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0}, \
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
  }
  #elif 0
  //      **********************#*****#**********************
  //      ********************************#******************
  //      ******************#*#*******#*##*******************
  //      ***************************************************
  //      **********##*******##*##***********#***************
  //      *************#***********##*##**#*******#**********
  //      *****************#**#***#***#****#*****************
  //      *******#************##********#******#*************
  //      ****#******#****#***#*#****##**##*****#*#**********
  //      *************#*#*###**#********#**###**************
  //      ****#************#***#**#**#####***##******#*#*****
  //      ***************#***##*##*##*#####***#****#*********
  //      ************###*#*#**##*#*#*##**#**#******#********
  //      ********#******#*#*##*###**####*#*##**##*#*********
  //      *************#*#**######*#########**#****#*********
  //      ***************####*#######**###**##****#***#******
  //      ***#****#***##*###****#######*##*#*#***************
  //      ****#****#*###**#**#######*###**###*#*#***#*#******
  //      *******#*#*#**#####**#*##*#####**##**#**##**#*#****
  //      ******###**##***#*###*#############*#****#*#*******
  //      ******#****#####*################*####*#*##********
  //      ************#*##**########################*********
  //      *#****##*###*##############*#####***#*#*##*#*#*****
  //      *#*******##**#*###########*######*########*****#***
  //      ****#***#**###*###################*#####***##***#**
  //      *#**###*####***###*######0######*##*###******#*****
  //      ****#******#*#*########**#########*#**#####*###****
  //      ******##**#**####*#####################***#******#*
  //      **#*****#*##**#*#######*###########*##*#*##********
  //      #***#***#**##*#################*###*##**#####******
  //      **#****#*#*#######*################**######*#******
  //      *******#***##*****#*########*####*##**#*####*******
  //      ###**##*****#*###*##*#*#*######*####**####**##**#**
  //      ***#**********##*###*##########****###*#***#*#*****
  //      **********#***#*###############**#***##****#*******
  //      *********##*#*#****###***##########***#************
  //      ****************############*******#******#**#*****
  //      *****************#*###*##*###*##*##*##*******#*****
  //      ****************#*#**###*##*#***#**#*******#*******
  //      *********#**#****##******####*##*##**#****#********
  //      ******#********#####**#*#****##**#*#***************
  //      ******************#****#******#********************
  //      *****************#**##**##**#**##*****#*****#******
  //      ******#***********##****#*******#**#***************
  //      **************#***##**#****#***#*******************
  //      *************#*******###*#****************#********
  //      **************************#********************#***
  //      ***************************************************
  //      *****************#******#***********#**************
  //      ***************************************************
  //      ************************#**************************
  #define SAMPLER_SIZE 25
  #define SAMPLER_DATA { \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0}, \
    {0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0}, \
    {0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0}, \
    {1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0}, \
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0} \
  }
  #elif 0
  //      *********************
  //      *********************
  //      **********#***#******
  //      *********************
  //      ********#************
  //      ********###*#*#******
  //      *******####**#*******
  //      *****#***##*#*##***#*
  //      ******#*####*##******
  //      ****#**######*#**#***
  //      *****#####0####**#***
  //      ********####*#####***
  //      ****#****###***##****
  //      *****####*#####******
  //      *****#####***#***#***
  //      *****#**###*****#****
  //      ********##***********
  //      ********##**#*#******
  //      *********#***********
  //      *********************
  //      *********************
  #define SAMPLER_SIZE 10
  #define SAMPLER_DATA { \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0}, \
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0} \
  }
  #elif 0
  //      ***************************************************
  //      ************************************************#**
  //      ***************************************************
  //      ***************************************************
  //      ***************************************************
  //      **********************************************#****
  //      *****************************************#*********
  //      ***************************************************
  //      ***************************************************
  //      ************************#******************#*******
  //      **********#***#************************************
  //      ******************#********************************
  //      *********#*****************************************
  //      *******#*******#*******##********#***#*************
  //      ********#********#*********#***********************
  //      *******************#******#***##*******************
  //      *********************************#*****************
  //      **************************#************************
  //      ************#****#********************#************
  //      *******#*******************************************
  //      *******************#***##***#********#*#***********
  //      *********************#********##*****#*************
  //      ******#******#*****************#******#************
  //      **********#***************#************************
  //      *******#***********#****###*##*#*******************
  //      **********#********#**#*#0#*****#******************
  //      *************#*****#****####***#*****#*************
  //      ********************************#******************
  //      **************#******#*##*##***#*******************
  //      **#****************#**********#*#******************
  //      **************************##***********************
  //      *****************************#****#****************
  //      ***#***********************#*#*********************
  //      ******************#********************************
  //      ***************#****************#**#***************
  //      ***************************************************
  //      **************#******#***********#*****************
  //      *******************#*************#*********#*******
  //      ***************************************************
  //      *******************#**********************#********
  //      ***************************************************
  //      ***************************************************
  //      **********************************#*********#******
  //      ****************************#**********************
  //      ***************************************************
  //      ***************************************************
  //      ***************************************************
  //      ***************************************************
  //      *************************#*************************
  //      ***************************************************
  //      ***************************************************
  #define SAMPLER_SIZE 25
  #define SAMPLER_DATA { \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0} \
  }
  #elif 0
  //      ***************#*****
  //      *********************
  //      ********##***********
  //      ******#**#*#***#*****
  //      *****#**#*#****#*****
  //      *****#***###**#****#*
  //      ****#*##*##***#****#*
  //      *****#*#######****##*
  //      *#**#########**#*****
  //      *******##########****
  //      *****###*#0##**##*#**
  //      ***##**########*##***
  //      ***#**##*##*#********
  //      **##***#######*#*****
  //      ***#*#**########*****
  //      *******#*************
  //      ***#*#**##****#*#****
  //      ******#*#**#*********
  //      *******#*#***********
  //      *******#*************
  //      ************#********
  #define SAMPLER_SIZE 10
  #define SAMPLER_DATA { \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0}, \
    {0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0}, \
    {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0}, \
    {0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0}, \
    {0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0}, \
    {0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, \
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0} \
  }


  #elif 1
//      *************************
//      *****************#*******
//      *********#*#*************
//      **********#**************
//      ****#****#****#**********
//      ********#*##***#*#*******
//      *******#***#**#####**#*#*
//      *#****#**#####*##*##*****
//      **#***######*#####*******
//      **#*****##########*#**#**
//      ***#*##***##*####**#*****
//      **#***############*#*#***
//      ******######0*##*###*****
//      #*##**########*######****
//      *******####*######*******
//      ******###*###*####*#*****
//      *******###*####****##****
//      *****######**#######*****
//      **#*#**#***###*##******#*
//      ******#****#*#***********
//      ********####*##**********
//      *******#*****###*********
//      *************###*********
//      ******#*#***##*******#***
//      *******#**********#******
#define SAMPLER_SIZE 12
#define SAMPLER_DATA { \
  {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, }, \
  {0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, }, \
  {0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, }, \
  {0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, }, \
  {0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, }, \
  {1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, }, \
  {0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, }, \
  {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, }, \
  {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, }, \
}
  #else 
  //###########
  //###########
  //###########
  //###########
  //###########
  //#####0#####
  //###########
  //###########
  //###########
  //###########
  //###########
  #define SAMPLER_SIZE 5
  #define SAMPLER_DATA { \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, \
  }
  #endif
#else 
  #if 0
  //      *****#******#***#****
  //      ******#**************
  //      ******#**************
  //      *********#*##********
  //      ****#**#*##*##*******
  //      ******#####*##**#****
  //      *******####*##*#*#***
  //      ***#*#*****##***#****
  //      **#**#####*##********
  //      ****##***#######*****
  //      **#*######0#*###*#***
  //      ******#*####*####**##
  //      *#***##**##*#####****
  //      ***##*#####**##*##***
  //      *****###*##*###******
  //      *****##*####**#**#***
  //      *****#**##**#*#*#*#**
  //      *********##*##*******
  //      ******#***#**#*******
  //      ***************#*****
  //      *********************
  #define SAMPLER_VECTOR_SIZE 508
  #define SAMPLER_VECTOR_DATA { \
    -1, -1, 0, 0, -1, 0, 0, 0, -1, 1, 0, 0, 0, -1, 0, 0, 0, 1, 0, 0 \
    , 1, -1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, -2, -2, 0, 0, -2, -1, 0, 0 \
    , -2, 1, 0, 0, -2, 2, 0, 0, -1, 2, 0, 0, 0, -2, 0, 0, 1, -2, 0, 0 \
    , 2, -1, 0, 0, 2, 0, 0, 0, 2, 2, 0, 0, -3, 1, 0, 0, -3, 2, 0, 0 \
    , -2, -3, 0, 0, -1, 3, 0, 0, 0, -3, 0, 0, 0, 3, 0, 0, 1, 3, 0, 0 \
    , 2, 3, 0, 0, 3, -3, 0, 0, 3, -2, 0, 0, 3, -1, 0, 0, 3, 0, 0, 0 \
    , 3, 3, 0, 0, -4, -3, 0, 0, -4, -2, 0, 0, -4, -1, 0, 0, -4, 0, 0, 0 \
    , -4, 2, 0, 0, -4, 3, 0, 0, -2, -4, 0, 0, -1, 4, 0, 0, 0, -4, 0, 0 \
    , 0, 4, 0, 0, 1, -4, 0, 0, 1, 4, 0, 0, 2, -4, 0, 0, 2, 4, 0, 0 \
    , 3, -4, 0, 0, 3, 4, 0, 0, 4, -4, 0, 0, 4, -3, 0, 0, 4, -1, 0, 0 \
    , 4, 0, 0, 0, 4, 2, 0, 0, 4, 3, 0, 0, 4, 4, 0, 0, -5, -4, 0, 0 \
    , -5, -3, 0, 0, -5, -2, 0, 0, -5, -1, 0, 0, -5, 0, 0, 0, -5, 2, 0, 0 \
    , -5, 3, 0, 0, -4, 5, 0, 0, -3, -5, 0, 0, -2, -5, 0, 0, -1, -5, 0, 0 \
    , -1, 5, 0, 0, 0, -5, 0, 0, 0, 5, 0, 0, 1, 5, 0, 0, 2, -5, 0, 0 \
    , 2, 5, 0, 0, 4, -5, 0, 0, 5, -5, 0, 0, 5, -4, 0, 0, 5, -2, 0, 0 \
    , 5, -1, 0, 0, 5, 0, 0, 0, 5, 1, 0, 0, 5, 4, 0, 0, -6, -6, 0, 0 \
    , -6, -3, 0, 0, -6, -1, 0, 0, -6, 0, 0, 0, -6, 2, 0, 0, -6, 3, 0, 0 \
    , -5, 6, 0, 0, -3, 6, 0, 0, -1, -6, 0, 0, 0, -6, 0, 0, 1, 6, 0, 0 \
    , 2, 6, 0, 0, 3, -6, 0, 0, 3, 6, 0, 0, 6, -5, 0, 0, 6, -2, 0, 0 \
    , 6, -1, 0, 0, 6, 2, 0, 0, 6, 4, 0, 0, 6, 6, 0, 0, -7, -1, 0, 0 \
    , -7, 1, 0, 0, -7, 2, 0, 0, -4, 7, 0, 0, -3, -7, 0, 0, 0, 7, 0, 0 \
    , 3, -7, 0, 0, 3, 7, 0, 0, 5, 7, 0, 0, 7, -1, 0, 0, 7, 0, 0, 0 \
    , 7, 2, 0, 0, 7, 3, 0, 0, -8, -4, 0, 0, -2, -8, 0, 0, 0, -8, 0, 0 \
    , 6, 8, 0, 0, 8, -4, 0, 0, 8, 0, 0, 0, 8, 3, 0, 0, -9, -4, 0, 0 \
    , 1, 9, 0, 0, 2, -9, 0, 0, 9, 5, 0, 0, -10, -5, 0, 0, -10, 2, 0, 0 \
    , -10, 6, 0, 0, 1, 10, 0, 0 \
  }
  #else
//      *************************
//      *****************#*******
//      *********#*#*************
//      **********#**************
//      ****#****#****#**********
//      ********#*##***#*#*******
//      *******#***#**#####**#*#*
//      *#****#**#####*##*##*****
//      **#***######*#####*******
//      **#*****##########*#**#**
//      ***#*##***##*####**#*****
//      **#***############*#*#***
//      ******######0*##*###*****
//      #*##**########*######****
//      *******####*######*******
//      ******###*###*####*#*****
//      *******###*####****##****
//      *****######**#######*****
//      **#*#**#***###*##******#*
//      ******#****#*#***********
//      ********####*##**********
//      *******#*****###*********
//      *************###*********
//      ******#*#***##*******#***
//      *******#**********#******
  #define SAMPLER_VECTOR_SIZE 740
  #define SAMPLER_VECTOR_DATA { \
    -1, -1, 0, 0, 0, -1, 0, 0, 1, -1, 0, 0, -1, 0, 0, 0, -1, 1, 0, 0 \
    , 0, 1, 0, 0, 1, 1, 0, 0, -2, -2, 0, 0, -1, -2, 0, 0, 1, -2, 0, 0 \
    , 2, -2, 0, 0, -2, -1, 0, 0, 2, -1, 0, 0, -2, 0, 0, 0, 2, 0, 0, 0 \
    , -2, 1, 0, 0, -2, 2, 0, 0, 0, 2, 0, 0, 1, 2, 0, 0, 2, 2, 0, 0 \
    , -3, -3, 0, 0, -2, -3, 0, 0, -1, -3, 0, 0, 0, -3, 0, 0, 1, -3, 0, 0 \
    , 2, -3, 0, 0, 3, -3, 0, 0, 3, -2, 0, 0, -3, -1, 0, 0, 3, -1, 0, 0 \
    , -3, 0, 0, 0, 3, 0, 0, 0, -3, 1, 0, 0, 3, 1, 0, 0, -3, 2, 0, 0 \
    , 3, 2, 0, 0, -2, 3, 0, 0, -1, 3, 0, 0, 0, 3, 0, 0, 2, 3, 0, 0 \
    , 3, 3, 0, 0, -4, -4, 0, 0, -3, -4, 0, 0, -2, -4, 0, 0, -1, -4, 0, 0 \
    , 1, -4, 0, 0, 2, -4, 0, 0, 3, -4, 0, 0, 4, -4, 0, 0, -4, -3, 0, 0 \
    , 4, -3, 0, 0, 4, -2, 0, 0, -4, -1, 0, 0, 4, -1, 0, 0, -4, 0, 0, 0 \
    , -4, 1, 0, 0, 4, 1, 0, 0, -4, 2, 0, 0, 4, 2, 0, 0, -4, 3, 0, 0 \
    , 4, 3, 0, 0, -4, 4, 0, 0, -3, 4, 0, 0, -1, 4, 0, 0, 0, 4, 0, 0 \
    , 1, 4, 0, 0, 2, 4, 0, 0, -3, -5, 0, 0, -2, -5, 0, 0, -1, -5, 0, 0 \
    , 0, -5, 0, 0, 1, -5, 0, 0, 3, -5, 0, 0, 4, -5, 0, 0, -5, -4, 0, 0 \
    , 5, -4, 0, 0, 5, -3, 0, 0, -5, -1, 0, 0, 5, -1, 0, 0, -5, 0, 0, 0 \
    , 5, 0, 0, 0, -5, 1, 0, 0, 5, 1, 0, 0, -5, 2, 0, 0, 5, 2, 0, 0 \
    , -5, 3, 0, 0, 5, 3, 0, 0, -5, 4, 0, 0, -5, 5, 0, 0, -4, 5, 0, 0 \
    , -3, 5, 0, 0, -2, 5, 0, 0, 1, 5, 0, 0, 2, 5, 0, 0, 3, 5, 0, 0 \
    , 4, 5, 0, 0, 5, 5, 0, 0, -5, -6, 0, 0, -1, -6, 0, 0, 2, -6, 0, 0 \
    , 3, -6, 0, 0, 4, -6, 0, 0, 5, -6, 0, 0, 6, -6, 0, 0, -6, -5, 0, 0 \
    , 6, -5, 0, 0, -6, -4, 0, 0, -6, -2, 0, 0, -6, -1, 0, 0, -6, 0, 0, 0 \
    , 6, 0, 0, 0, -6, 1, 0, 0, 6, 1, 0, 0, -6, 3, 0, 0, -6, 5, 0, 0 \
    , 6, 5, 0, 0, -5, 6, 0, 0, -1, 6, 0, 0, 0, 6, 0, 0, 1, 6, 0, 0 \
    , 3, 6, 0, 0, 4, 6, 0, 0, -4, -7, 0, 0, -2, -7, 0, 0, -1, -7, 0, 0 \
    , 3, -7, 0, 0, 5, -7, 0, 0, 7, -5, 0, 0, 7, -3, 0, 0, -7, -2, 0, 0 \
    , 7, -2, 0, 0, 7, -1, 0, 0, 7, 0, 0, 0, 7, 1, 0, 0, 7, 3, 0, 0 \
    , 7, 4, 0, 0, -7, 5, 0, 0, 7, 5, 0, 0, -6, 7, 0, 0, -1, 7, 0, 0 \
    , 1, 7, 0, 0, -8, -8, 0, 0, -3, -8, 0, 0, 2, -8, 0, 0, 8, 1, 0, 0 \
    , 8, 4, 0, 0, -8, 6, 0, 0, -4, 8, 0, 0, -3, 8, 0, 0, -2, 8, 0, 0 \
    , -1, 8, 0, 0, 1, 8, 0, 0, 2, 8, 0, 0, -2, -9, 0, 0, 9, -6, 0, 0 \
    , -9, -2, 0, 0, 9, -1, 0, 0, -9, 1, 0, 0, -5, 9, 0, 0, 1, 9, 0, 0 \
    , 2, 9, 0, 0, 3, 9, 0, 0, -3, -10, 0, 0, -1, -10, 0, 0, -10, -4, 0, 0 \
    , -10, -3, 0, 0, 10, -3, 0, 0, -10, -1, 0, 0, -10, 1, 0, 0, -10, 6, 0, 0 \
    , 1, 10, 0, 0, 2, 10, 0, 0, 3, 10, 0, 0, 5, -11, 0, 0, 11, -6, 0, 0 \
    , -11, -5, 0, 0, 11, 6, 0, 0, -6, 11, 0, 0, -4, 11, 0, 0, 0, 11, 0, 0 \
    , 1, 11, 0, 0, 9, 11, 0, 0, -12, 1, 0, 0, -5, 12, 0, 0, 6, 12, 0, 0 \
  }
  #endif
#endif




KernelSSAO::KernelSSAO(int width, int height, 
                       GLuint positionTexId, 
                       GLuint depht0_normalTexId, GLuint depht1_normalTexId, 
                       GLuint depht2_normalTexId)
: KernelBase("./resources/Shaders/ssao.vert", "./resources/Shaders/ssao.frag", width, height){
	//Output
  m_colorTexId = addOutput(0);

	//Input
	m_shader->setActive(true);
    addInputTexture(GL_TEXTURE_2D, "positionTex", positionTexId);
    addInputTexture(GL_TEXTURE_2D, "depth0_normalTex", depht0_normalTexId);
    addInputTexture(GL_TEXTURE_2D, "depth1_normalTex", depht1_normalTexId);
    addInputTexture(GL_TEXTURE_2D, "depth2_normalTex", depht2_normalTexId);
#ifdef SAMPLER_SIZE
    addInputTexture(GL_TEXTURE_2D, "sampleTex", createSampleTexture());
    addInputFloat("samplerSize", (GLfloat)SAMPLER_SIZE);
#endif

#ifdef SAMPLER_VECTOR_SIZE
    addInputTexture(GL_TEXTURE_1D, "sampleTex", createSampleTexture());
    addInputFloat("samplerSize", (GLfloat)SAMPLER_VECTOR_SIZE/4.0f);
#endif


    addInputFloat("screenWidth", width);
    addInputFloat("screenHeight", height);
	m_shader->setActive(false);
}

KernelSSAO::~KernelSSAO(){

}

GLuint KernelSSAO::getColorTexId() const
{
  return m_colorTexId; 
}

void KernelSSAO::step(float* projectionMatrix, float rfar, float pixelmask_size, GLfloat offsets_size, GLfloat intensity)
{
  float x = projectionMatrix[0*4+0];
  float y = projectionMatrix[1*4+1];
  float z = projectionMatrix[2*4+2];
  float w = projectionMatrix[3*4+2];
  float z_near = w/(z - 1.0);
  float z_far = w * z_near/(w + 2.0 * z_near);
  float right = z_near/x;
  float top = z_near/y;

  m_shader->setActive(true);
    addInputFloat("rfar", rfar);
    addInputFloat("pixelmask", pixelmask_size);
    addInputFloat("near", z_near);
    addInputFloat("far", z_far);
    addInputFloat("right", right);
    addInputFloat("top", top);
    addInputFloat("offsets_size", offsets_size);
    addInputFloat("intensity", intensity);
  m_shader->setActive(false);
  KernelBase::step();
}


GLuint KernelSSAO::createSampleTexture()
{
#ifdef SAMPLER_QUAD  
  GLenum target = GL_TEXTURE_2D;
  int size = SAMPLER_SIZE;
  int mem_size = (2*size+1);
  float samples[2*SAMPLER_SIZE+1][2*SAMPLER_SIZE+1] = SAMPLER_DATA;

  GLfloat *pixels = new GLfloat[mem_size*mem_size*4];
  for(int i=0; i < mem_size; ++i)
    for(int j = 0; j < mem_size; ++j)
    {  
      pixels[i*mem_size*4 + j*4 + 0] = pixels[i*mem_size*4 + j*4 + 1] = pixels[i*mem_size*4 + j*4 + 2] =  0;
      pixels[i*mem_size*4 + j*4 + 3] = samples[i][j];
    }
#else
  GLenum target = GL_TEXTURE_1D;
  int mem_size = SAMPLER_VECTOR_SIZE / 4;

  GLfloat pixels[] = SAMPLER_VECTOR_DATA;
#endif

  GLuint dummyTexId;
  glGenTextures(1, &dummyTexId);
  glBindTexture(target, dummyTexId);
  glTexParameterf(target, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
  glTexParameterf(target, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
  glTexParameterf(target, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
  glTexParameterf(target, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
  glTexParameteri(target, GL_GENERATE_MIPMAP, GL_TRUE); 
#ifdef SAMPLER_QUAD 
  glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA32F_ARB, mem_size, mem_size, 0, GL_RGBA, GL_FLOAT, pixels);
#else
  glTexImage1D(GL_TEXTURE_1D, 0, GL_RGBA32F_ARB, mem_size, 0, GL_RGBA, GL_FLOAT, pixels);
#endif
  glBindTexture(target, 0);
  return dummyTexId;
}